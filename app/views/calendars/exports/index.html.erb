<% content_for(:title, "Calendars") %>
<% decorator = Calendars::ExportDecorator.new(current_community, current_user) %>

<div class="row">
  <div class="col-sm-6">
    <div class="links personalized-links">
      <h2 class="top">Personalized Calendars</h2>
      <p>Personalized calendars include information tailored for you or your household.</p>
      <%= decorator.calendar_link("your_meals") %>
      <%= decorator.calendar_link("all_meals") %>
      <%= decorator.calendar_link("community_meals") if multi_community? %>
      <%= decorator.calendar_link("your_jobs") %>
      <%= decorator.calendar_link("community_events") %>
      <%= decorator.calendar_link("your_events") %>
    </div>

    <div class="links community-links">
      <h2>Community Calendars</h2>
      <p>These calendars are not tailored to any individual user so they are suitable for use in a shared context.</p>
      <%= decorator.calendar_link("all_meals", personalized: false) %>
      <%= decorator.calendar_link("community_meals", personalized: false) if multi_community? %>
      <%= decorator.calendar_link("community_events", personalized: false) %>
    </div>
  </div>
  <div class="col-sm-6">
    <div class="callout">
      <h4><%= icon_tag("share-alt") %> A Note on Sharing</h4>
      Personalized calendar links are tailored and unique to you, so don't share them. If you want to tell
      someone about this fun feature, send them the
      <%= link_to("link to this page", calendars_exports_path) %>,
      not an individual calendar.
    </div>

    <h2>Import Instructions</h2>

    <h3><%= icon_tag("google") %> Google Calendar</h3>
    <h4>Method 1</h4>
    If you are signed in to your Google account, try simply clicking the link of the calendar you
    want to import. Google Calendar should open on its own and ask you to import.
    <h4>Method 2</h4>
    <ol>
      <li>Click 'Copy Link' above to copy the calendar URL to the clipboard.</li>
      <li>On the left of the Google Calendar screen, click the '+' next to 'Add a friend's calendar'.</li>
      <li>Click 'From URL'.</li>
      <li>Paste the URL you copied above.</li>
      <li>Click 'Add Calendar'.</li>
      <li>The events should appear on your calendar after a few seconds.</li>
    </ol>

    <h3><%= icon_tag("apple") %> Apple Calendar</h3>
    <h4>Method 1</h4>
    Try simply clicking the link of the calendar you want to import. If your browser is set to handle
    webcal links with Apple Calendar, it may just work!
    <h4>Method 2</h4>
    <ol>
      <li>Click 'Copy Link' above to copy the calendar URL to the clipboard.</li>
      <li>Open Apple Calendar.</li>
      <li>Click the 'File' menu.</li>
      <li>Click 'Subscribe' or 'New Calendar Subscription'.</li>
      <li>Paste the URL you copied above.</li>
      <li>Click OK/Subscribe.</li>
      <li>Set subscription options if prompted. Recommended auto-refresh interval is 'every hour'.</li>
      <li>The events should now appear on your calendar.</li>
    </ol>
  </div>
</div>

<div class="footnote">
  If you accidentally share your personalized calendar links and want to make them private again,
  <%= link_to("click here to reset your secret token", calendars_exports_reset_token_path, method: :put) %>.
  Note: This will make the old links inoperative, so you will need to update your calendar app.
</div>
