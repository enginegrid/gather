<% content_for(:title) { "Google Drive" } %>
<% content_for(:action_links) do %>
  <% if @auth_policy.index? %>
    <%= link_to(icon_tag("gear") << " Setup",
                gdrive_auth_url(host: Settings.url.host, community_id: current_community.id),
                class: "btn btn-primary") %>
  <% end %>
<% end %>

<% if @config&.complete? %>
  <% if @ancestors.any? %>
    <div class="breadcrumbs">
      <%= link_to(icon_tag("home"), gdrive_home_path) %><span class="divider">></span><%=
        safe_join(@ancestors.map { |a| link_to(a.name, gdrive_folder_path(a.id)) },
          content_tag(:span, " > ", class: "divider")) %>
    </div>
  <% end %>
  <% if @file_list.files.any? %>
    <table class="full-width">
      <% @file_list.files.each do |file| %>
        <tr>
          <td>
            <%= image_tag(file.icon_link, class: "file-icon") %>
            <% if file.mime_type == "application/vnd.google-apps.folder" %>
              <%= link_to(file.name, gdrive_folder_path(folder_id: file.id)) %>
            <% else %>
              <%= link_to(file.name, file.web_view_link, target: "_blank") %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </table>
  <% else %>
  <div class="center-notice">
    No files found in this folder.
  </div>
  <% end %>
<% else %>
  <div class="center-notice">
    Your community has not yet been configured for Google Drive.
    <% if @auth_policy.index? %>
      You can click <strong>Setup</strong> above to get started.
    <% else %>
      Please talk to a Gather Admin about getting Google Drive set up.
    <% end %>
  </div>
<% end %>
